<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>扶뒬못</title>
</head>
<body style="margin:0;background:#000;overflow:hidden;cursor:grab;">
    <div id="imageContainer" style="position:relative;width:100vw;height:100vh;overflow:hidden;">
        <img src="data:image/jpeg;base64,/9j/4AAQSkZJRgABAQABAQABAQAAAAYABAAIQAwALQBAgIBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBDs="
             alt="扶뒬못"
             id="cvImage"
             style="position:absolute;image-rendering:crisp-edges;image-rendering:pixelated;transform-origin:0 0;">
    </div>
    
    <script>
        let scale = 1;
        let offsetX = 20;
        let offsetY = 20;
        let isDragging = false;
        let lastX, lastY;
        let initialDistance = 0;
        let initialScale = 1;
        let pinchCenterX = 0;
        let pinchCenterY = 0;
        const img = document.getElementById('cvImage');
        const container = document.getElementById('imageContainer');
        
        window.addEventListener('load', function() {
            img.style.width = img.naturalWidth + 'px';
            img.style.height = img.naturalHeight + 'px';
            
            updateTransform();
        });
        
        function updateTransform() {
            img.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${scale})`;
        }
        
        container.addEventListener('wheel', function(e) {
            e.preventDefault();
            
            const zoomAmount = 0.1;
            const oldScale = scale;
            
            if (e.deltaY < 0) {
                scale = Math.min(scale + zoomAmount, 5.0);
            } else {
                scale = Math.max(scale - zoomAmount, 0.5);
            }
            
            const rect = container.getBoundingClientRect();
            const mouseX = e.clientX - rect.left;
            const mouseY = e.clientY - rect.top;
            
            const imgX = (mouseX - offsetX) / oldScale;
            const imgY = (mouseY - offsetY) / oldScale;
            
            offsetX = mouseX - imgX * scale;
            offsetY = mouseY - imgY * scale;
            
            updateTransform();
        });
        
        container.addEventListener('mousedown', function(e) {
            isDragging = true;
            lastX = e.clientX;
            lastY = e.clientY;
            container.style.cursor = 'grabbing';
            e.preventDefault();
        });
        
        document.addEventListener('mousemove', function(e) {
            if (!isDragging) return;
            
            const deltaX = e.clientX - lastX;
            const deltaY = e.clientY - lastY;
            
            offsetX += deltaX;
            offsetY += deltaY;
            
            lastX = e.clientX;
            lastY = e.clientY;
            
            updateTransform();
        });
        
        document.addEventListener('mouseup', function() {
            isDragging = false;
            container.style.cursor = 'grab';
        });
        
        container.addEventListener('touchstart', function(e) {
            if (e.touches.length === 1) {
                isDragging = true;
                lastX = e.touches[0].clientX;
                lastY = e.touches[0].clientY;
                container.style.cursor = 'grabbing';
                e.preventDefault();
            } else if (e.touches.length === 2) {
                isDragging = false;
                initialDistance = Math.hypot(
                    e.touches[0].clientX - e.touches[1].clientX,
                    e.touches[0].clientY - e.touches[1].clientY
                );
                initialScale = scale;
                
                const rect = container.getBoundingClientRect();
                pinchCenterX = (e.touches[0].clientX + e.touches[1].clientX) / 2 - rect.left;
                pinchCenterY = (e.touches[0].clientY + e.touches[1].clientY) / 2 - rect.top;
                
                e.preventDefault();
            }
        });
        
        container.addEventListener('touchmove', function(e) {
            if (e.touches.length === 1 && isDragging) {
                const deltaX = e.touches[0].clientX - lastX;
                const deltaY = e.touches[0].clientY - lastY;
                
                offsetX += deltaX;
                offsetY += deltaY;
                
                lastX = e.touches[0].clientX;
                lastY = e.touches[0].clientY;
                
                updateTransform();
                e.preventDefault();
            } else if (e.touches.length === 2) {
                isDragging = false;
                
                const currentDistance = Math.hypot(
                    e.touches[0].clientX - e.touches[1].clientX,
                    e.touches[0].clientY - e.touches[1].clientY
                );
                
                if (initialDistance > 0) {
                    const scaleFactor = currentDistance / initialDistance;
                    const newScale = Math.max(0.5, Math.min(5.0, initialScale * scaleFactor));
                    const rect = container.getBoundingClientRect();
                    const currentCenterX = (e.touches[0].clientX + e.touches[1].clientX) / 2 - rect.left;
                    const currentCenterY = (e.touches[0].clientY + e.touches[1].clientY) / 2 - rect.top;
                    const avgCenterX = (pinchCenterX + currentCenterX) / 2;
                    const avgCenterY = (pinchCenterY + currentCenterY) / 2;
                    const imgX = (avgCenterX - offsetX) / scale;
                    const imgY = (avgCenterY - offsetY) / scale;
                    scale = newScale;
                    offsetX = avgCenterX - imgX * scale;
                    offsetY = avgCenterY - imgY * scale;
                    
                    updateTransform();
                }
                
                e.preventDefault();
            }
        });
        
        container.addEventListener('touchend', function(e) {
            if (e.touches.length === 0) {
                isDragging = false;
                initialDistance = 0;
                container.style.cursor = 'grab';
            } else if (e.touches.length === 1) {
                isDragging = true;
                lastX = e.touches[0].clientX;
                lastY = e.touches[0].clientY;
                initialDistance = 0;
            }
        });
        
        container.addEventListener('dblclick', function() {
            if (window.opener) {
                window.close();
            } else {
                window.history.back();
            }
        });
        
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                if (window.opener) {
                    window.close();
                } else {
                    window.history.back();
                }
            }
        });
    </script>
</body>
</html>
